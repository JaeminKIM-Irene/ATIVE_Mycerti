 <html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    
    <title>마이써티</title>
    <link rel="stylesheet" href="../resources/css/reset.css" />
    <link rel="stylesheet" href="../resources/css/font.css" />
    <link rel="stylesheet" href="../resources/css/reset.css" />
    <link rel="stylesheet" href="../resources/css/common.css" />
    <link rel="stylesheet" href="../resources/css/skin.css" />
    
    <script src="../library/js/jquery-3.5.1.min.js"></script>
</head>
<body> 
    <div id="wrap">
        <div class="bg_wrap">
            <div class="bg_area">
                <div class="bg_contents_area">
                    <h1>
                        <img src="../resources/image/logo_mycerti.png" alt="Mycerti"/>
                    </h1>
                    <div class="bg_text_area">
                        <span>병원 증명서 발급부터 보험사 청구까지</span>
                        <strong>병원 방문없이 온라인으로 간단하게</strong>
                        <h2>마이써티</h2>
                    </div>
                </div>
                <main>
                    <header>
                        <a href="#" class="go_back">뒤로가기</a>
                        <span class="title">정보입력</span>
                        <button type="button" class="exit">닫기</button>
                    </header>
                    <div class="contents_area full_type">
                        <div class="fix_type_title pb_set">
                            <span class="top_text">김이름 님의 의무기록사본</span>
                            <strong class="title">발급조건 선택</strong>
                            <span class="bot_text">
                                기타에는 필요한 내용을 자세히 작성해주세요.
                                <em>영상CD는 직접 방문하여 신청해주셔야 합니다.</em>
                            </span>
                        </div>
                        <div class="inner_scroll_contents">
                            <ul class="inner_list type_sub_chk_area">
                                <li class="box">
                                    <input type="checkbox" id="chk01" name="chk_info"/>
                                    <label for="chk01">
                                        전체기록
                                    </label>
                                </li>
                                <li class="box">
                                    <input type="checkbox" id="chk02" name="chk_info"/>
                                    <label for="chk02">
                                        <span>입원기록</span>
                                        <span class="sub_text">초진기록지, 외래진료기록지, 응급실기록지</span>
                                        <em class="guide_text">세부항목을 선택해주세요.</em>
                                    </label>
                                    <div class="sub_chk_area sub_outer_wrap">
                                        <ul class="sub_list sub_wrap">
                                            <li class="inner_box">
                                                <input type="checkbox" id="chk01-1"/>
                                                <label for="chk01-1">
                                                    초진기록지
                                                </label>
                                            </li>
                                            <li class="inner_box">
                                                <input type="checkbox" id="chk01-2"/>
                                                <label for="chk01-2">
                                                    초진기록지
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li class="box">
                                    <input type="checkbox" id="chk04" name="chk_info"/>
                                    <label for="chk04">
                                        <span>입원기록</span>
                                        <span class="sub_text">초진기록지, 외래진료기록지, 응급실기록지</span>
                                        <em class="guide_text">세부항목을 선택해주세요.</em>
                                    </label>
                                    <div class="sub_chk_area sub_outer_wrap">
                                        <ul class="sub_list sub_wrap">
                                            <li class="inner_box">
                                                <input type="checkbox" id="chk02-1"/>
                                                <label for="chk02-1">
                                                    초진기록지
                                                </label>
                                            </li>
                                            <li class="inner_box">
                                                <input type="checkbox" id="chk02-2"/>
                                                <label for="chk02-2">
                                                    초진기록지
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li class="box">
                                    <input type="checkbox" id="chk03" name="chk_info"/>
                                    <label for="chk03">
                                        <span>기타</span>
                                        <span class="sub_text">직접입력이 가능합니다.</span>
                                        <em class="guide_text">직접입력이 가능합니다.</em>
                                    </label>
                                    
                                    <div class="sub_text_area sub_outer_wrap">
                                        <div class="sub_wrap">
                                            <textarea placeholder="상단 체크 목록에 없는 검사 결과를 자세히 작성해주세요."></textarea>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                            <p class="list_guide_text">
                                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 18 18" style="enable-background:new 0 0 18 18;" xml:space="preserve">
                                <circle class="st0" cx="9" cy="9" r="7.3"/>
                                <path class="st1" d="M9,5.7V9"/>
                                <path class="st1" d="M9,11.7V12"/>
                                </svg>
                                각종 진단서, 소견서, 확인서, 영상DVD 복사, 영수증 등은 신청하실 수 없습니다.
                            </p>
                        </div>
                        <div class="bot_btn_area scroll_text_type">
                            <button type="button" class="btn colorA typeA">다음</button>
                        </div>
                        <div class="modal_background">
                            <div class="nurse_tab">
                                <div class="sub_text">간호기록지 세부항목을 선택해주세요.</div>
                                <div class="guide_text">최소 한 개 이상 선택해주세요.</div>
                                <div class="sub_chk_area sub_outer_wrap">
                                    <ul class="sub_list sub_wrap">
                                        <li class="inner_box">
                                            <input type="checkbox" id="chk05-1"/>
                                            <label for="chk05-1">
                                                간호초기평가
                                            </label>
                                        </li>
                                        <li class="inner_box">
                                            <input type="checkbox" id="chk05-2"/>
                                            <label for="chk05-2">
                                                퇴원간호계획지
                                            </label>
                                        </li>
                                        <li class="inner_box">
                                            <input type="checkbox" id="chk05-3"/>
                                            <label for="chk05-3">
                                                간호기록(서술문)
                                            </label>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nurse_tab_btns">
                                    <button class="cancel_btn1">취소</button>
                                    <button class="confirm_btn" disabled="disabled">확인</button>
                                </div>
                            </div>
                            <div class="detail_tab">
                                <div class="sub_text">필요한 검사결과지를<br>자세히 작성해주세요.</div>
                                <div class="textarea_container">
                                    <textarea id="detail_content" placeholder="내용을 입력해주세요." class="detail_input"></textarea>
                                </div>
                                <div class="nurse_tab_btns">
                                    <button class="cancel_btn2">취소</button>
                                    <button class="confirm_btn2" disabled="disabled">확인</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div> <!-- div#wrap -->
    <script src="../resources/js/common.js"></script>
    <script>
        $(function(){
            // 상위 체크박스 목록 체크 시
            $(document).on('change','.type_sub_chk_area .box > input[type="checkbox"]',function(){
                var indexChk = $(this).parents('.box').index();
                var listHi = $(this).parents('.box').find('.sub_wrap').outerHeight();
                var chkVal = $(this).prop('checked');
                var totalLth = $(this).parents('.type_sub_chk_area').find('.box').length;
                
                // 전체기록 외의 기록을 체크한 경우
                if(indexChk != 0){
                    if(!!chkVal){
                        $(this).parents('.box').addClass('on');
                        $(this).parents('.box').find('input[type="checkbox"]').prop('checked',true);
                        $(this).parents('.box').find('.sub_outer_wrap').css('height',(listHi+16)+'px');
                    }
                    else {
                        $(this).parents('.box').removeClass('on');
                        $(this).parents('.box').find('input[type="checkbox"]').prop('checked',false);
                        $(this).parents('.box').find('.sub_outer_wrap').css('height','0px');
                    }
                    // 상위 목록 체크
                    totalChk();
                }
                // 전체기록을 체크한 경우
                else {
                    if(!!chkVal){
                        $(this).parents('.box').addClass('on');
                        $('.type_sub_chk_area .box > input[type="checkbox"]').each(function(){
                            var thisIndex = $(this).parents('.box').index();
                            
                            if((thisIndex != 0) && (thisIndex != totalLth-1)){
                                var thisListHi = $(this).parents('.box').find('.sub_wrap').outerHeight();
                                $(this).parents('.box').addClass('on');
                                $(this).parents('.box').find('.sub_outer_wrap').css('height',(thisListHi+16)+'px');
                                $(this).prop('checked',true);
                                $(this).parents('.box').find('input[type="checkbox"]').prop('checked',true);
                            }
                        });
                    }
                    else {
                        $('.type_sub_chk_area .box > input[type="checkbox"]').each(function(){
                            var thisIndex = $(this).parents('.box').index();
                            
                            if(thisIndex != totalLth-1){
                                $(this).parents('.box').removeClass('on');
                                $(this).parents('.box').find('.sub_outer_wrap').css('height','0px');
                                $(this).prop('checked',false);
                                $(this).parents('.box').find('input[type="checkbox"]').prop('checked',false);
                            }
                        });
                    }
                }
            });
            
            // 세부 체크박스 목록 체크 시
            $(document).on('change','.type_sub_chk_area .inner_box input[type="checkbox"]',function(){
                // 상위 목록 체크
                totalChk();
                var innerChkLth = $(this).parents('.sub_list').find('input[type="checkbox"]:checked').length;
                // 내부 체크    
                if(innerChkLth == 0){
                    $(this).parents('.box').removeClass('on');
                    $(this).parents('.box').children('input[type="checkbox"]').prop('checked',false);
                    $(this).parents('.box').find('.sub_outer_wrap').css('height','0px');
                }
            });
        })
        
        function totalChk(){
            var totalListLth = $('.type_sub_chk_area .inner_box input[type="checkbox"]').length;
            var totalChkLth = $('.type_sub_chk_area .inner_box input[type="checkbox"]:checked').length;

            

            // 상위 체크
            if(totalListLth == totalChkLth){
                $('.type_sub_chk_area .box:eq(0)').addClass('on');
                $('.type_sub_chk_area .box:eq(0) > input[type="checkbox"]').prop('checked',true);
            }
            else {
                $('.type_sub_chk_area .box:eq(0)').removeClass('on');
                $('.type_sub_chk_area .box:eq(0) > input[type="checkbox"]').prop('checked',false);
            }
        }

        //확인버튼 활성화
        $(document).on('change','.modal_background .nurse_tab .sub_chk_area .inner_box input[type="checkbox"]',function(){
            
            var totalChkLth = $('.modal_background .sub_chk_area .inner_box input[type="checkbox"]:checked').length;
            
            if(totalChkLth > 0){
                $(".confirm_btn").attr("disabled", false);
            }
            else {
                $(".confirm_btn").attr("disabled", true);
            }
        });

        //모달 열기/닫기
        $(document).on('click', '.btn', function() {
            $('.modal_background, .nurse_tab').addClass('active');
        })
        $(document).on('click', '.cancel_btn1', function() {
            setTimeout(function(){
                    $('.modal_background').removeClass('active');
                },300);
                $('.nurse_tab').removeClass('active');
        })
        $(document).on('click', '.confirm_btn', function() {
            if ($('#chk05-3').is(':checked')) {
                $('.nurse_tab').removeClass('active');
                $('.detail_tab').addClass('active');
            }
            else {
                setTimeout(function(){
                    $('.modal_background').removeClass('active');
                },300);
                $('.nurse_tab').removeClass('active');
            }
        })
        $(document).on('click', '.confirm_btn2, .cancel_btn2', function() {
            setTimeout(function(){
                    $('.modal_background').removeClass('active');
                },300);
                $('.detail_tab').removeClass('active');
        })

        //textarea 상태별 css
        $(document).on('input', '#detail_content', function() {
            if ($("#detail_content").val().length > 0){
                $('.textarea_container').addClass('text_filled');
                $(".confirm_btn2").attr("disabled", false);
            }
            else {
                $('.textarea_container').removeClass('text_filled');
                $(".confirm_btn2").attr("disabled", true);
            }
        })

        $('#detail_content').focus(function() {
            $('.textarea_container').addClass('textarea_focus');
        }) 
        $('#detail_content').blur(function() {
            $('.textarea_container').removeClass('textarea_focus');
        })

        //textarea 글자수 제한(100)
        $('#detail_content').on('keyup', function() {
            if($(this).val().length > 100) {
                $(this).val($(this).val().substring(0, 100));
            }
    });
    </script>
</body>
</html>